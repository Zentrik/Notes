\part{Inhomogenous ODEs; Fourier Transforms}
\section{Dirac delta function}

\begin{definition}[Dirac Delta Function]
	We define a generalised function $\delta(x - \xi)$ such that
	\begin{align}
		\begin{aligned} \label{eq:6.1}
			&\delta(x-\xi) = 0 \ \ \forall \; x \neq \xi; \\
			&\int_{-\infty}^\infty \delta(x-\xi) \dd{x} = 1.
		\end{aligned} 	
	\end{align} 
	% \begin{enumerate}
	% 	\item $\delta(x-\xi) = 0$ for all $x \neq \xi$;
	% 	\item $\int_{-\infty}^\infty \delta(x-\xi) \dd{x} = 1$.
	% \end{enumerate}
	This acts as a linear operator $\int \dd{x} \delta(x - \xi)$ on some arbitrary function $f(x)$ to produce a number $f(\xi)$.
	\begin{align} \label{eq:6.2}
		\int_{-\infty}^\infty \dd{x} \delta(x-\xi) f(x) = f(\xi)
	\end{align}
	This relationship holds provided that $f(x)$ is sufficiently `well-behaved' at $x=\xi$ and $x\to\pm \infty$.
\end{definition}

\begin{note}
	\begin{itemize}
		\item Strictly, the $\delta$ `function' is classified as a distribution, not as a function.
		See lectures notes of Jozsa and Skinner section 6.1 for more details.
		\item For this reason, we will never use $\delta$ outside an integral, although such an integral may be implied.
		\item The $\delta$ function represents a unit point source (e.g. mass, charge) or an impulse.
	\end{itemize} 
\end{note}

\subsection{Some limiting approximations}

A discrete approximation as $n \to \infty$ is $\delta_n = \begin{cases}
	0 & x > \frac{1}{n} \\
	\frac{n}{2} & |x| \leq \frac{1}{n} \\
	0 & x < - \frac{1}{n}
\end{cases}$.
\begin{figure}[h] 
    \centering 
    \includegraphics[height=5cm]{06-discretedelta} 
	\caption{Discrete approximation}
\end{figure}

\underline{Continuous:}
We can approximate the $\delta$ function using a Gaussian approximation as $\epsilon \to 0$.
\begin{align} \label{eq:6.3}
	\delta_\varepsilon(x) = \frac{1}{\varepsilon \sqrt{\pi}} \exp[-\frac{x^2}{\varepsilon^2}]
\end{align}
Therefore verifying \cref{eq:6.2},
\begin{align*}
	\int_{-\infty}^\infty f(x) \delta(x) \dd{x} & = \lim_{\varepsilon \to 0} \int_{-\infty}^\infty \frac{1}{\varepsilon \sqrt{\pi}} \exp[-\frac{x^2}{\varepsilon^2}] f(x) \dd{x}
	\intertext{Let $y = \frac{x}{\epsilon}$,}
    & = \lim_{\varepsilon \to 0} \int_{-\infty}^\infty \frac{1}{\sqrt{\pi}} \exp[-y^2] f(\varepsilon y) \dd{y} \\
    & = \lim_{\varepsilon \to 0} \int_{-\infty}^\infty \frac{1}{\sqrt{\pi}} \exp[-y^2] [f(0) + \varepsilon y f'(0) + \cdots] \dd{y} \\
    & = f(0)
\end{align*}
for all `well-behaved functions' $f$ at $0, \pm \infty$\footnote{Well behaved at $0$ lets us taylor expand and well behaved at $\pm \infty$ means it doesn't diverge faster than the Gaussian.}.
\begingroup
\tikzset{every picture/.style={scale=0.8}}
\begin{center}
	\input{figures/06-GaussianApproximation.tex}
\end{center} 
\endgroup

\underline{Further Examples}
We could alternatively use the Dirichlet kernel (as $n \to \infty$)
\begin{align} \label{eq:6.4}
	\delta_n(x) = \frac{\sin n x}{\pi x} = \frac{1}{2\pi} \int_{-n}^n e^{ikx} \dd{k}
\end{align}
or even
\begin{align} \label{eq:6.5}
	\delta_n(x) = \frac{n}{2} \sech^2 nx
\end{align}

\subsection{Integral and derivative of delta function}
\subsubsection{Integral of $\delta(x)$}
We define the Heaviside step function by
\begin{align} \label{eq:6.6}
	H(x) = \begin{cases}
		1 & x \geq 0 \\
		0 & x < 0
	\end{cases}
\end{align}
For $x \neq 0$, we have
\begin{align} \label{eq:6.7}
	H(x) = \int_{-\infty}^x \delta(t) \dd{t}
\end{align}
Thus,
\begin{align*}
	\dv{x} H(x) = \delta(x)
\end{align*}
where this identification takes place under an implied integral.

\begin{exercise}
	Verify using \cref{eq:6.5} $\delta(x) = \lim_{n \to \infty} \frac{n}{2} \sech^2 nx$ [You will find $\frac{1}{2} (\tanh nx + 1)$ which is an approximate step function. This also gives $H(0) = \frac{1}{2}$ (an alternative definition)].
\end{exercise} 

\subsubsection{Derivative of $\delta(x)$}
We define $\delta'(x)$ using integration by parts.
\begin{align}
	\int_{-\infty}^\infty \delta'(x-\xi) f(x) \dd{x} &= \qty[\delta(x-\xi) f(x)]_{-\infty}^\infty - \int_{-\infty}^\infty \delta(x-\xi) f'(x) \dd{x} \notag \\
    &= - \int_{-\infty}^\infty \delta(x-\xi) f'(x) \dd{x} \notag \\
    \int_{-\infty}^\infty \delta'(x-\xi) f(x) \dd{x} &= - f'(\xi) \label{eq:6.8}
\end{align}
This is valid for all $f$ that are smooth at $x = \xi$.
\begin{example}
	Consider the Gaussian approximation \cref{eq:6.3}:
	\begin{align*}
		\delta_\varepsilon(x) = \frac{1}{\varepsilon \sqrt{\pi}} \exp[-\frac{x^2}{\varepsilon^2}]
	\end{align*}
	Then,
	\begin{align*}
		\delta_\varepsilon'(x) = \frac{-2x}{\varepsilon^3 \sqrt{\pi}} \exp[-\frac{x^2}{\varepsilon^2}]
	\end{align*}

	\begingroup
	\tikzset{every picture/.style={scale=0.8}}
	\begin{center}
		\input{figures/06-GaussianApproximationDerivative.tex}
	\end{center} 
	\endgroup
\end{example}

\subsection{Properties of delta function}
\subsubsection{Sampling Property}
Note that
\begin{align} \label{eq:6.9}
	\int_a^b f(x) \delta(x-\xi) \dd{x} = \begin{cases}
		f(\xi) & a < \xi < b \\
		0 & \text{otherwise}
	\end{cases}
\end{align}
So the $\delta$ function only `samples' values within the integral range.
This is known as the sampling property.

\subsubsection{Even Property}
Let $u = -(x-\xi)$, and consider
\begin{align*}
	\int_{-\infty}^\infty f(x) \delta\qty(-(x-\xi)) \dd{x} &= \int_{\infty}^{-\infty} f(\xi - u) \delta(u) (-\dd{u}) \\
    &= \int_{-\infty}^\infty f(\xi - u) \delta(u) \dd{u} \\
    &= f(\xi)
\end{align*}
Hence,
\begin{align} \label{eq:6.10}
	\int_{-\infty}^\infty f(x) \delta\qty(-(x-\xi)) \dd{x} = \int_{-\infty}^\infty f(x) \delta(x-\xi) \dd{x}
\end{align}
This is called the even property.

\subsubsection{Scaling Property}
Now, consider
\begin{align} \label{eq:6.11}
	\int_{-\infty}^\infty f(x) \delta(a(x-\xi)) \dd{x} = \frac{1}{\abs{a}}f(\xi)
\end{align}

\begin{exercise}
	Show this using $u = ax$ (noting integral limit order with $a < 0$).
\end{exercise} 

\subsubsection{Advanced Scaling Property}
Let $g(x)$ be a function with $n$ isolated roots at $x_1, \dots, x_n$.
Then, assuming $g'(x)$ does not vanish at the $x_i$,
\begin{align} \label{eq:6.12}
	\delta(g(x)) = \sum_{i=1}^n \frac{\delta(x - x_i)}{\abs{g'(x_i)}}
\end{align}
This is a generalisation of the above, known as the advanced scaling property.
\begin{exercise}
	Show for $g$ has $1$ root at $x = x_i$.
\end{exercise} 

\begin{example}
	\begin{align*}
		I &= \int_{-\infty}^{\infty} f(x) \delta(x^2 - 1) \dd{x} \\
		&= \int_{1 - \epsilon}^{1 + \epsilon} f(x) \frac{\delta(x - 1)}{|2x|} \dd{x} + \int_{-1 - \epsilon}^{-1 + \epsilon} f(x) \frac{\delta(x + 1)}{|2x|} \dd{x} \\
		&= \frac{1}{2} (f(1) + f(-1)).
	\end{align*} 
\end{example} 

\subsubsection{Isolation Property}
Now, if $g(x)$ is continuous at $x = 0$, then 
\begin{align}
	g(x) \delta(x) = g(0) \delta(x) \label{eq:6.13}
\end{align} 
inside an integral.

\begin{exercise}
	Evaluate and show $\int_{0}^{\infty} \delta'(x^2 - 1) x^2 \dd{x} = - \frac{1}{4}$ using $u = x^2 - 1$ and $\cref{eq:6.8}$ and $\cref{eq:6.12}$.
\end{exercise} 

\subsection{Fourier series expansion of delta function}
Consider a complex Fourier series expansion,
\begin{align*}
	\delta(x) = \sum_{n=-\infty}^\infty c_n e^{in\pi x/L};\quad c_n = \frac{1}{2L}\int_{-L}^L \delta(x) e^{-i n \pi x / L} \dd{x} = \frac{1}{2L}
\end{align*}
Hence,
\begin{align} \label{eq:6.14}
	\delta(x) = \frac{1}{2L} \sum_{n=-\infty}^\infty e^{in\pi x/L}
\end{align}
Let $f(x)$ be a function, so $f(x) = \sum_{n=-\infty}^\infty d_n e^{in \pi x / L}$.
Then (using section 2.2), their inner product is given by
\begin{align*}
	\int_{-L}^L f^\star(x) \delta(x) \dd{x} = \frac{1}{2L} \sum_{n = -\infty}^\infty d_n \int_{-L}^L e^{in \pi x/L} e^{in \pi x/L} \dd{x} = \sum_{n = -\infty}^\infty d_n = f(0)
\end{align*}
The Fourier expansion of the $\delta$ function can be extended periodically to the whole real line.
This infinite set of $\delta$ functions is known as the \vocab{Dirac comb}, given by
\begin{align*}
	\sum_{m = -\infty}^\infty \delta(x-2mL) = \frac{1}{2L} \sum_{n = -\infty}^\infty e^{in \pi x/L}
\end{align*}

\subsection{Arbitrary eigenfunction expansion of delta function}
In general, suppose
\begin{align*}
	\delta(x-\xi) = \sum_{n=1}^\infty a_n y_n(x),\quad a \leq x \leq b
\end{align*}
with coefficients, \cref{eq:2.17}
\begin{align*}
	a_n &= \frac{\int_a^b w(x) y_n(x) \delta(x-\xi) \dd{x}}{\int_a^b w(x) y_n(x)^2 \dd{x}} 
	\\ &= \frac{w(\xi) y_n(\xi)}{\int_a^b w(x) y_n(x)^2 \dd{x}} \\
	&= w_n(\xi) Y_n(\xi) \text{ for unit norm \cref{eq:2.18}}
\end{align*}
Then,
\begin{align*}
	\delta(x-\xi) = w(\xi) \sum_{n=1}^\infty Y_n(\xi) Y_n(x) = w(x) \sum_{n=1}^\infty Y_n(\xi) Y_n(x)
\end{align*}
since $\frac{w(x)}{w(\xi)} \delta(x - \xi) = \delta(x - \xi)$ by \cref{eq:6.13}.
Hence,
\begin{align} \label{eq:6.15}
	\delta(x-\xi) = w(x) \sum_{n=1}^\infty \frac{y_n(\xi) y_n(x)}{\mathcal{N}_n}
\end{align}
where $\mathcal{N}_n = \int_a^b w y_n^2 \dd{x}$ is a normalisation factor.
\begin{example}
	Consider a Fourier series for $y(0) = y(1) = 0$, with $y_n(x) = \sin n \pi x$.
	From the sine series coefficient expression \cref{eq:1.11},
	\begin{align*}
		\delta(x-\xi) = 2\sum_{n=1}^\infty \sin n \pi \xi \sin n \pi x
	\end{align*}
	where $0 < \xi < 1$.
\end{example}

\begin{exercise}
	\begin{enumerate}
		\item Integrate both sides to show $\sum_{m=1}^{\infty} \frac{(-1)^{m+1}}{2m-1} = \frac{1}{4}$ when $\epsilon= \frac{1}{2}$.
		\item Integrate twice and compare with $G(x, \xi)$ \cref{eq:1.25} or \cref{eq:2.31}.
	\end{enumerate} 
\end{exercise} 